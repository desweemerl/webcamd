diff --git a/drivers/media/i2c/adv7343.c b/drivers/media/i2c/adv7343.c
index aeb56c5..a05a4e1 100644
--- a/drivers/media/i2c/adv7343.c
+++ b/drivers/media/i2c/adv7343.c
@@ -403,10 +403,11 @@ static int adv7343_initialize(struct v4l2_subdev *sd)
 static struct adv7343_platform_data *
 adv7343_get_pdata(struct i2c_client *client)
 {
+#if IS_ENABLED(CONFIG_OF)
 	struct adv7343_platform_data *pdata;
 	struct device_node *np;
 
-	if (!IS_ENABLED(CONFIG_OF) || !client->dev.of_node)
+	if (!client->dev.of_node)
 		return client->dev.platform_data;
 
 	np = v4l2_of_get_next_endpoint(client->dev.of_node, NULL);
@@ -432,6 +433,9 @@ adv7343_get_pdata(struct i2c_client *client)
 done:
 	of_node_put(np);
 	return pdata;
+#else
+	return client->dev.platform_data;
+#endif
 }
 
 static int adv7343_probe(struct i2c_client *client,
@@ -528,7 +532,9 @@ MODULE_DEVICE_TABLE(of, adv7343_of_match);
 
 static struct i2c_driver adv7343_driver = {
 	.driver = {
+#if IS_ENABLED(CONFIG_OF)
 		.of_match_table = of_match_ptr(adv7343_of_match),
+#endif
 		.owner	= THIS_MODULE,
 		.name	= "adv7343",
 	},
